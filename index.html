<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Esp√≠ritu Guardi√°n - Simulaci√≥n Tribal</title>
  </head>
  <body>
    <div id="app">
      <header id="game-header">
        <div class="header-left">
          <h1 class="game-title">üåü Esp√≠ritu Guardi√°n</h1>
        </div>
        <nav class="header-nav">
          <button class="header-btn" id="btn-new-game" title="Nueva Partida">üîÑ Nueva</button>
          <button class="header-btn" id="btn-save" title="Guardar Partida">üíæ Guardar</button>
          <button class="header-btn" id="btn-load" title="Cargar Partida">üìÇ Cargar</button>
          <button class="header-btn" id="btn-settings" title="Configuraci√≥n">‚öôÔ∏è Config</button>
          <button class="header-btn" id="btn-help" title="Ayuda">‚ùì Ayuda</button>
          <appkit-button />
        </nav>
      </header>
      <div id="layout">
        <aside id="left-panel">
          <section class="panel-block" id="citizen-panel">
            <h2>Aldeanos</h2>
            <div class="citizen-panel">
              <div class="citizen-list" id="citizen-list"></div>
              <div class="citizen-detail" id="citizen-detail">
                <p class="citizen-detail-empty">Selecciona un habitante para ver sus detalles.</p>
              </div>
            </div>
          </section>
        </aside>

        <div id="game-wrapper">
          <canvas id="game"></canvas>
          <div id="zoom-controls" role="group" aria-label="Controles de zoom">
            <button type="button" class="zoom-btn" id="zoom-out" title="Alejar mapa">‚àí</button>
            <button type="button" class="zoom-btn" id="zoom-in" title="Acercar mapa">+</button>
          </div>
        </div>

        <aside id="ui-panel">
          <section class="panel-block">
            <h2>Tribu</h2>
            <div class="stat-grid">
              <span id="score" data-label="Fe">0</span>
              <span id="energy" data-label="Poblaci√≥n">0</span>
              <span id="time" data-label="Clima">Templado</span>
            </div>
          </section>

          <section class="panel-block">
            <h2>Reservas</h2>
            <div class="stat-grid">
              <span id="food" data-label="Comida">0</span>
              <span id="stone" data-label="Piedra">0</span>
              <span id="water" data-label="Agua">0</span>
            </div>
          </section>

          <section class="panel-block" id="roles-panel">
            <h2>Oficios</h2>
            <div class="role-control" data-role="farmer">
              <label for="role-farmer">Granjero</label>
              <input type="range" id="role-farmer" min="0" max="10" value="2" step="1" />
              <span class="role-value" id="role-value-farmer">2</span>
            </div>
            <div class="role-control" data-role="worker">
              <label for="role-worker">Trabajador</label>
              <input type="range" id="role-worker" min="0" max="10" value="2" step="1" />
              <span class="role-value" id="role-value-worker">2</span>
            </div>
            <div class="role-control" data-role="warrior">
              <label for="role-warrior">Guerrero</label>
              <input type="range" id="role-warrior" min="0" max="10" value="2" step="1" />
              <span class="role-value" id="role-value-warrior">2</span>
            </div>
            <div class="role-control" data-role="scout">
              <label for="role-scout">Explorador</label>
              <input type="range" id="role-scout" min="0" max="10" value="1" step="1" />
              <span class="role-value" id="role-value-scout">1</span>
            </div>
            <p class="role-note">Los ni√±os y ancianos no se reasignan autom√°ticamente.</p>
          </section>

          <section class="panel-block" id="planning-panel">
            <h2>Planificaci√≥n</h2>
            <div class="planning-modes" role="group" aria-label="Modos de planificaci√≥n">
              <button type="button" class="planning-button" data-planning-mode="farm" title="Planificar cultivos (F)">
                üåæ Cultivos
              </button>
              <button type="button" class="planning-button" data-planning-mode="mine" title="Planificar canteras (M)">
                ü™® Miner√≠a
              </button>
              <button type="button" class="planning-button" data-planning-mode="gather" title="Planificar recolecci√≥n (G)">
                üçÉ Recolecci√≥n
              </button>
              <button
                type="button"
                class="planning-button"
                data-planning-mode="build"
                title="Modo construcci√≥n (B) ¬∑ usa [ ] para cambiar edificio"
              >
                üß± Construcci√≥n
              </button>
            </div>
            <div class="planning-build-selector collapsed" id="build-selector" aria-hidden="true">
              <div class="planning-selector-row">
                <span class="selector-label">Edificio:</span>
                <div class="planning-selector-controls">
                  <button type="button" class="planning-cycle-btn" id="build-prev" title="Edificio anterior ([)">
                    ‚óÄ
                  </button>
                  <span class="planning-selector-name" id="build-name">Ninguno</span>
                  <button type="button" class="planning-cycle-btn" id="build-next" title="Edificio siguiente (])">
                    ‚ñ∂
                  </button>
                </div>
              </div>
              <small class="planning-status" id="build-status">Aumenta la poblaci√≥n para desbloquear edificios.</small>
              <div class="build-details" id="build-details" hidden>
                <p class="build-details-summary" id="build-details-summary">Selecciona un edificio para ver detalles.</p>
                <p class="build-details-meta">
                  <span class="build-details-label">Coste:</span>
                  <span id="build-details-cost">-</span>
                </p>
                <p class="build-details-meta">
                  <span class="build-details-label">Requisitos:</span>
                  <span id="build-details-requirements">-</span>
                </p>
              </div>
            </div>
            <div class="planning-hint" id="planning-hint">Selecciona un modo para empezar a marcar zonas.</div>
          </section>

          <section class="panel-block" id="instructions">
            <h2>Controles</h2>
            <ul>
              <li>WASD / Flechas: mover al esp√≠ritu (3√ó3 celdas).</li>
              <li>1 Explorar ¬∑ 2 Defender ¬∑ 3 Farmear ¬∑ 4 Minar ¬∑ 0 limpiar.</li>
              <li>Panel de Planificaci√≥n o teclas F/M/G/B para pintar zonas. Usa [ y ] para cambiar de edificio.</li>
              <li>Rueda sobre el mapa o usa + / ‚àí para hacer zoom.</li>
              <li>Arrastra con el click medio para desplazar el mapa.</li>
              <li>E / Espacio: bendecir. T: invocar t√≥tem.</li>
            </ul>
            <p id="status-text">Simulaci√≥n en curso.</p>
            <div id="speed-controls" class="speed-controls" role="group" aria-label="Velocidad de simulaci√≥n">
              <span class="speed-label">Velocidad:</span>
              <div class="speed-button-group">
                <button type="button" class="panel-button speed-button" data-speed="1">1√ó Normal</button>
                <button type="button" class="panel-button speed-button" data-speed="2">2√ó</button>
                <button type="button" class="panel-button speed-button" data-speed="5">5√ó</button>
              </div>
            </div>
            <div class="panel-actions">
              <button id="pause-button" class="panel-button">‚è∏Ô∏è Pausar</button>
              <button id="debug-export" class="panel-button" disabled>‚¨áÔ∏è Descargar debug</button>
            </div>
          </section>

          <section class="panel-block" id="history-panel">
            <h2>Cr√≥nica</h2>
            <ul id="history"></ul>
          </section>
        </aside>
      </div>
    </div>
    <script type="module" src="/src/main.ts"></script>
  </body>
</html>
